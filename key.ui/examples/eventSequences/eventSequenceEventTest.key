\javaSource "methodExample/"; // location of class definitions

\sorts{
    Event;
}

\programVariables {
  Person p;
  int x;
}

\predicates {
}

\functions{
    \unique Event event(Object, MethodName, Seq);
    \unique Pair condEvent(Event, boolean);
}

\schemaVariables {
    \modalOperator {diamond, box, diamond_transaction, box_transaction} #allmodal;
    \modalOperator {diamond, diamond_transaction} #diamond;
    \modalOperator {box, box_transaction} #box;
    \program SimpleExpression #se, #se0, #se1, #se2;
    \program MethodName #mn;
    \program SimpleExpression #seMn;
    \program [list] SimpleExpression #selist;
    \program [list] Expression #elist;
}

\rules(programRules:Java, runtimeExceptions:ban) {
  newEvent_mc {
      \schemaVar \term Object rp;
      \schemaVar \term MethodName mn;
      \schemaVar \term Seq params;
      \schemaVar \formula post;
      \find(\modality{#allmodal}{.. #se.#mn(#selist); ...}\endmodality post)
      \varcond(\getObject(rp, #se), \getMethodName(mn, #se, #mn, #selist), \getParams(params, #selist))
      \replacewith({\eventUpdate(event(rp, mn, params))}\modality{#allmodal}{.. #method-call(#se.#mn(#selist)); ...}\endmodality (post))
      \heuristics(update_apply)
  };
}

\problem {
          {p.age:=2} // assign initial value to 'age'
            (   x = 0 & p != null
             -> \<{
                    p.birthday();
                    p.grow();
                  }\> (p.age > x))
}